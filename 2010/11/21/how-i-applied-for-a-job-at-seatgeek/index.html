<!DOCTYPE html>
<html>
  <head>
    <title>How I applied for a job at SeatGeek</title>
    
  </head>
  <body>
      <h1><a href="http://example.org/">Tavish Armstrong</a></h1>
      <h4><span><a href="http://example.org/about/">About</a></span></h4>

        <h1>How I applied for a job at SeatGeek</h1>
        <h6>Sun 21 Nov 2010 12:39:00</h6>
        <p>On Friday I was nerd-sniped by SeatGeek. They&rsquo;re looking for a new
programmer, and instead of going through Monster or other online job
sites, they made their own job application. To apply, you had to hack
into it. I couldn&rsquo;t resist the challenge, even though I&rsquo;m in school and
I don&rsquo;t need a job.</p>

<p>When you go to <a href="http://apply.seatgeek.com/">http://apply.seatgeek.com/</a>,
you see a message that says:</p>

<blockquote>
<p>This page must be viewed using the SeatGeek browser.</p>
</blockquote>

<p><img src="/photos/seatgeek/useragent.png" alt="User agent
challenge" /></p>

<p>Websites don&rsquo;t actually test what browser you&rsquo;re using. Your browser
just tells the website what its name is (well, there are probably other
ways to test, but you get the point). When you go to a website in
Firefox, Firefox will happily say &ldquo;Hey Google, my name is Firefox 3.6 on
Linux!&rdquo; Your browser is under your control, so you can change this quite
easily (directions are for Firefox):</p>

<ol>
<li>Open a new tab. Type about:config into the address bar, and hit
enter.</li>
<li>Search for <code>useragent</code>. You&rsquo;ll see a setting called
<code>general.useragent.extra.firefox</code>.</li>
<li>Change the value to &ldquo;SeatGeek&rdquo;.</li>
</ol>

<p>Now, if you refresh the page, you&rsquo;ll see the full job application form.</p>

<p><img src="/photos/seatgeek/ignorethis.png" alt="Full job
application" /></p>

<p>But wait! There&rsquo;s a problem: &ldquo;only &lsquo;admin&rsquo; users may submit new
applicants.&rdquo;</p>

<p>This took me about an hour to figure out. First, I viewed source (ctrl-u
on firefox) and saw the following:</p>

<pre><code>&lt;input name=&quot;_csrf&quot; value=&quot;this is required (and this value is incorrect)&quot; type=&quot;hidden&quot;&gt;
</code></pre>

<p>They were dropping me pretty big hints here. I tried changing the value
to &lsquo;admin&rsquo; in <a href="http://getfirebug.com/">Firebug</a>, but when I submitted my
application, all I got was a blank page (it was actually a 403 Forbidden
error page).</p>

<p>I tried to remember what CSRF stood for. Ah, right: Cross-Site Request
Forgery. Basically, this is how a lot of phishing works: they put a
login form for GMail on their website that looks a lot like the real
GMail login form, you type in your credentials, and they forward you on
to GMail <em>after they&rsquo;ve read your credentials</em>. This is why looking at
the address bar and making sure you&rsquo;re on the site you think you&rsquo;re on
is useful.</p>

<p>So, with that in mind, I checked my cookies. This is what I found:</p>

<pre><code>sg.session=%7B%22admin%22%3A0%2C%22admin%22%3A0%2C%22csrf.token%22%3A%22UMZF2REa8eojqIgxaxI3z8267tcb1b%2F0NzfnNSu2qvQ%3D%22%7D;
</code></pre>

<p>If that doesn&rsquo;t make sense to you, you&rsquo;re not alone. But, if you look
closely, you&rsquo;ll notice that &ldquo;csrf&rdquo; and &ldquo;admin&rdquo; are in there. Aha! We&rsquo;re
getting warmer.</p>

<p>I opened the PHP prompt and URLDecoded the cookie string. (If you don&rsquo;t
know how to do that, go
<a href="http://www.string-functions.com/urldecode.aspx">here</a>.) This is what I
got:</p>

<pre><code>sg.session={&quot;admin&quot;:0,&quot;admin&quot;:0,&quot;csrf.token&quot;:&quot;UMZF2REa8eojqIgxaxI3z8267tcb1b/0NzfnNSu2qvQ=&quot;};
</code></pre>

<p>Awesome. When I&rsquo;m submitting this form, my browser is telling the
website &ldquo;hey, I&rsquo;m not an admin (0 is false), and my csrf token is [that
long string of text up there]&ldquo;. This is really bad security, since, as I
said before, you control your browser. So you can tell the website
whatever you want, if you know how to open up your browser. Naturally, I
can <a href="https://addons.mozilla.org/af/firefox/addon/4510/">edit my cookie</a>
to say <code>&quot;admin&quot;:1</code> instead. That csrf token is what I want to put into
the HTML input tag I was talking about earlier, like this:</p>

<pre><code>&lt;input name=&quot;_csrf&quot; value=&quot;UMZF2REa8eojqIgxaxI3z8267tcb1b/0NzfnNSu2qvQ=&quot; type=&quot;hidden&quot;&gt;
</code></pre>

<p>The reason why websites do this (usually automatically &ndash; they don&rsquo;t
want you to have to edit the HTML to log in!) is so that they know the
login form (or job app form) you&rsquo;re using was authorized by them. The
server knows about that long string of characters, and will make sure
that any job applications include one of these &ldquo;tokens&rdquo; they&rsquo;ve issued.</p>

<p>Now I could fill out the form and hit submit. And it worked!</p>

<p><img src="/photos/seatgeek/seatgeek_win.png" alt="Win!" /></p>

<p>So, there you have it. This is a pretty contrived example of hacking
(they made it easy on purpose), but this is actually how a lot of it
happens. The server expects you to tell the truth, and doesn&rsquo;t have
safeguards in place to make sure you are honest.</p>

<p>Hopefully this has been an interesting look into the world of hacking.
Let me know if you don&rsquo;t understand something. I was trying to make this
somewhat comprehensible for a non-programmer, so if you don&rsquo;t get it,
let me know.</p>

<hr />

<p>Notes:</p>

<ol>
<li>The image of the filled-out form doesn&rsquo;t match the image of me being
successful, since the success image is from when I submitted using
my real name and resume.</li>
<li>If you&rsquo;re following along, make sure you change your <code>useragent</code>
back to the default, or you&rsquo;ll get funny messages on certain
websites.</li>
</ol>

</body>
</html>

